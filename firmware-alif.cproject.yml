# yaml-language-server: $schema=https://raw.githubusercontent.com/Open-CMSIS-Pack/devtools/tools/projmgr/2.6.0/tools/projmgr/schemas/cproject.schema.json
project:

  groups:
    - group: App
      files:
        - file: app/main.cpp
        - file: app/ei_main.cpp
        - file: app/inference_task.cpp
        - file: app/lcd_task.cpp
          for-context:
            - +HE
            - +HP
            - +HP_SRAM
    - group: EdgeImpulse
      files:
        - file: app/edge-impulse/ingestion-sdk-platform/alif-e7/ei_classifier_porting.cpp
        - file: app/edge-impulse/ingestion-sdk-platform/alif-e7/ei_device_alif_e7.cpp
        - file: app/edge-impulse/ingestion-sdk-platform/alif-e7/ei_at_handlers.cpp
        - file: app/edge-impulse/ingestion-sdk-platform/sensor/ei_microphone.cpp
        - file: app/edge-impulse/ingestion-sdk-platform/sensor/ei_camera.cpp
          not-for-context:
            - +E1C
        - file: app/edge-impulse/ingestion-sdk-platform/sensor/ei_inertial.cpp
        - file: app/edge-impulse/inference/ei_run_camera_impulse.cpp
        - file: app/edge-impulse/inference/ei_run_fusion_impulse.cpp
        - file: app/edge-impulse/inference/ei_run_audio_impulse.cpp
    - group: FW-SDK
      files:
        - file: app/edge-impulse/firmware-sdk/at-server/ei_at_server_singleton.cpp
        - file: app/edge-impulse/firmware-sdk/at-server/ei_at_server.cpp
        - file: app/edge-impulse/firmware-sdk/at-server/ei_at_parser.cpp
        - file: app/edge-impulse/firmware-sdk/at-server/ei_at_command_set.cpp
        - file: app/edge-impulse/firmware-sdk/ei_image_lib.cpp
        - file: app/edge-impulse/firmware-sdk/ei_device_lib.cpp
        - file: app/edge-impulse/firmware-sdk/at_base64_lib.cpp
        - file: app/edge-impulse/firmware-sdk/jpeg/JPEGENC.cpp
        - file: app/edge-impulse/firmware-sdk/ei_fusion.cpp
        - file: app/edge-impulse/ingestion-sdk-c/ei_sampler.cpp
        - file: app/edge-impulse/ingestion-sdk-c/sensor_aq_mbedtls_hs256.cpp
        - file: app/edge-impulse/firmware-sdk/sensor-aq/sensor_aq.cpp
        - file: app/edge-impulse/firmware-sdk/QCBOR/src/qcbor_encode.c
        - file: app/edge-impulse/firmware-sdk/QCBOR/src/UsefulBuf.c
        - file: app/edge-impulse/firmware-sdk/QCBOR/src/ieee754.c
    - group: Board
      files:
        - file: app/peripheral/peripheral.c
        - file: app/peripheral/uart.c
        - file: app/peripheral/timer.c
        - file: libs/board/appkit_gen2/board_init.c
          for-context:
            - +HE
            - +HP
            - +HP_SRAM
        - file: libs/board/devkit_gen2/board_init.c
          for-context:
            - +HE_DEVKIT
            - +HP_DEVKIT
            - +HP_SRAM_DEVKIT
        - file: libs/board/devkit_e1c/board_init.c
          for-context:
            - +E1C
        - file: app/peripheral/camera/camera.c
          not-for-context:
            - +E1C
        - file: app/peripheral/camera/color_correction.c
          not-for-context:
            - +E1C
        - file: app/peripheral/camera/image_processing.c
          not-for-context:
            - +E1C
        - file: app/peripheral/camera/bayer2rgb.c
          not-for-context:
            - +E1C
        - file: app/peripheral/inertial/bmi323_icm42670.c
        - file: app/peripheral/inertial/i2c_over_i3c.c
        - file: libs/common_app_utils/logging/retarget.c
        - file: libs/common_app_utils/logging/uart_tracelib.c
        - file: libs/common_app_utils/fault_handler/fault_handler.c
    - group: Graphic
      files:
        - file: app/graphic/graphic.c
        - file: app/graphic/aipl/cpu_cache.c
        - file: app/graphic/aipl/video_alloc.c
        - file: app/graphic/image/ei_alif_logo.c
        - file: app/graphic/image/image.c
        - file: app/graphic/text/text.c
      for-context:
        - +HE
        - +HP
        - +HP_SRAM
    - group: Npu
      files:
        - file: app/npu/npu_handler.cpp
        - file: app/npu/ethosu_cpu_cache.c
        - file: app/npu/ethosu_platform_callbacks.c

  linker:
    - script: link-scripts/gcc_M55_HE.ld
      for-compiler: GCC
      for-context:
        - +HE
        - +HE_DEVKIT
    - script: link-scripts/gcc_M55_HP.ld
      for-compiler: GCC
      for-context:
        - +HP
        - +HP_SRAM
        - +HP_DEVKIT
        - +HP_SRAM_DEVKIT
    - script: link-scripts/gcc_M55_HE_E1C.ld
      for-compiler: GCC
      for-context:
        - +E1C
  add-path:
    - ./
    - app/
    - app/edge-impulse
    - libs/board/
    - app/edge-impulse/ingestion-sdk-platform/sensor
    - app/edge-impulse/ingestion-sdk-c
    - app/edge-impulse/firmware-sdk
    - libs/common_app_utils/fault_handler
  define:
    - ETHOSU55
    - EI_ETHOS
    - EI_ALIF_ADDR_TRANSLATION
    - ARM_NPU
    - ETHOS_U_NPU_ID: 55
    - ETHOS_U_NPU_MEMORY_MODE: Shared_Sram
    - ETHOS_U_NPU_CONFIG_ID: H256
    - ETHOS_U_NPU_TIMING_ADAPTER_ENABLED: Off
    - NPU_QCONFIG: 1
    - NPU_REGIONCFG_0: 1
    - NPU_REGIONCFG_1: 0
    - NPU_REGIONCFG_2: 1
    - AXI_LIMIT0_MEM_TYPE: 3
    - AXI_LIMIT1_MEM_TYPE: 3
    - AXI_LIMIT2_MEM_TYPE: 3
    - AXI_LIMIT3_MEM_TYPE: 3
    - TF_LITE_STATIC_MEMORY

  components:
    # needed for Alif Ensemble support    
    - component: ARM::CMSIS:CORE
    - component: ARM::CMSIS:DSP
    - component: ARM::CMSIS:NN Lib
    - component: Arm::Machine Learning:NPU Support:Ethos-U Driver&Generic U55
    
    # FreeRTOS components
    - component: ARM::RTOS&FreeRTOS:Core&Cortex-M
    - component: ARM::RTOS&FreeRTOS:Config&FreeRTOS
    - component: ARM::RTOS&FreeRTOS:Event Groups
    - component: ARM::RTOS&FreeRTOS:Timers
    - component: ARM::RTOS&FreeRTOS:Heap&Heap_4

    # Alif components
    - component: AlifSemiconductor::Device:Startup&C Startup

    # peripheral drivers & middleware, uncomment as needed
    # - component: AlifSemiconductor::Device:SOC Peripherals:ADC
    # - component: AlifSemiconductor::Device:SOC Peripherals:CAN-FD
    - component: AlifSemiconductor::Device:SOC Peripherals:CDC
      not-for-context:
        - +E1C
    - component: AlifSemiconductor::Device:SOC Peripherals:CPI
    # - component: AlifSemiconductor::Device:SOC Peripherals:CRC
    # - component: AlifSemiconductor::Device:SOC Peripherals:DAC
    - component: AlifSemiconductor::Device:SOC Peripherals:DMA
    # - component: AlifSemiconductor::Device:SOC Peripherals:Ethernet MAC
    - component: AlifSemiconductor::Device:SOC Peripherals:GPIO
    # - component: AlifSemiconductor::Device:SOC Peripherals:HSCMP
    # - component: AlifSemiconductor::Device:SOC Peripherals:HWSEM
    - component: AlifSemiconductor::Device:SOC Peripherals:I2C
    # - component: AlifSemiconductor::Device:SOC Peripherals:I2C_I3C
    - component: AlifSemiconductor::Device:SOC Peripherals:I2S
    - component: AlifSemiconductor::Device:SOC Peripherals:I3C
    # - component: AlifSemiconductor::Device:SOC Peripherals:LPI2C
    # - component: AlifSemiconductor::Device:SOC Peripherals:LPTIMER
    # - component: AlifSemiconductor::Device:SOC Peripherals:MHU
    - component: AlifSemiconductor::Device:SOC Peripherals:MIPI DSI CSI2 DPHY
      not-for-context:
        - +E1C
    - component: AlifSemiconductor::Device:SOC Peripherals:MIPI CSI2
      not-for-context:
        - +E1C
    - component: AlifSemiconductor::Device:SOC Peripherals:MIPI DSI
      not-for-context:
        - +E1C
    # - component: AlifSemiconductor::Device:SOC Peripherals:MRAM
    # - component: AlifSemiconductor::Device:SOC Peripherals:OSPI
    # - component: AlifSemiconductor::Device:SOC Peripherals:PDM
    - component: AlifSemiconductor::Device:SOC Peripherals:PINCONF
    # - component: AlifSemiconductor::Device:SOC Peripherals:RTC
    # - component: AlifSemiconductor::Device:SOC Peripherals:SDMMC
    # - component: AlifSemiconductor::Device:SOC Peripherals:SPI
    - component: AlifSemiconductor::Device:SOC Peripherals:USART
    - component: AlifSemiconductor::Device:SOC Peripherals:UTIMER
    # - component: AlifSemiconductor::Device:SOC Peripherals:WDT

    # - component: AlifSemiconductor::Device:OSPI XIP:core
    # - component: AlifSemiconductor::Device:OSPI XIP:utility    

    - component: AlifSemiconductor::Device:SOC Peripherals:MHU
    - component: AlifSemiconductor::Device:SE runtime Services:core&Source
    - component: AlifSemiconductor::Device:SE runtime Services:Initialization
        Helper&Source

    - component: AlifSemiconductor::BSP:External peripherals:CAMERA Sensor MT9M114

    # - component: AlifSemiconductor::BSP:External peripherals:CAMERA Sensor ARX3A0
    # - component: AlifSemiconductor::BSP:External peripherals:Ethernet PHY
    # - component: AlifSemiconductor::BSP:External peripherals:GT911 Touch Controller
    - component: AlifSemiconductor::BSP:External peripherals:ILI9806E LCD panel
      not-for-context:
        - +E1C
    # - component: AlifSemiconductor::BSP:External peripherals:OSPI Flash ISSI
  

    # D/AVE2D driver
    - component: AlifSemiconductor::Graphics:DAVE2D:Layer2
      for-context:
      - +HE
      - +HP
      - +HP_SRAM
    - component: AlifSemiconductor::Graphics:DAVE2D:Layer1
      for-context:
      - +HE
      - +HP
      - +HP_SRAM
    - component: AlifSemiconductor::Graphics:DAVE2D:Layer0Lib
      for-context:
      - +HE
      - +HP
      - +HP_SRAM

      # AIPL
    - component: AlifSemiconductor::Graphics:AIPL:Essential
      for-context:
      - +HE
      - +HP
      - +HP_SRAM
    - component: AlifSemiconductor::Graphics:AIPL:Basic
      for-context:
      - +HE
      - +HP
      - +HP_SRAM
    - component: AlifSemiconductor::Graphics:Acceleration:Dave2d
      for-context:
      - +HE
      - +HP
      - +HP_SRAM
    - component: AlifSemiconductor::Graphics:AIPL:Color correction
      for-context:
      - +HE
      - +HP
      - +HP_SRAM
    - component: AlifSemiconductor::Graphics:AIPL:Color conversion
      for-context:
      - +HE
      - +HP
      - +HP_SRAM
    - component: AlifSemiconductor::Graphics:AIPL:Bayer    
      for-context:
      - +HE
      - +HP
      - +HP_SRAM

  layers:
    - layer: ./model/edgeimpulse.clayer.yml

  output:
    base-name: $Project$-$TargetType$
    type:
      - elf
      - bin
